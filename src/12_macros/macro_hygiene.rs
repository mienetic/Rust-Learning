//! # Macro Hygiene and Advanced Features - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÅ‡∏ö‡∏ö Clean Magic! üßπ‚ú®
//!
//! ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á macro hygiene ‡πÅ‡∏•‡∏∞ features ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á
//! ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏®‡∏¥‡∏•‡∏õ‡∏∞‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå! ü™Ñüßº
//!
//! üéØ **‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢**: ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏ó‡∏µ‡πà‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢!

/// ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á macro hygiene - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÅ‡∏ö‡∏ö Hygiene Spells! üßπüîÆ
pub fn macro_hygiene_examples() {
    println!("\nüßº‚ú® === ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Macro Hygiene - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î! === ‚ú®üßº");
    println!("ü™Ñ ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ä‡∏ô‡∏Å‡∏±‡∏ô! üõ°Ô∏è");

    // üßπ Macro ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏†‡∏≤‡∏¢‡πÉ‡∏ô - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏ô‡∏Å‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£! üõ°Ô∏è‚ú®
    macro_rules! using_internal_var {
        ($x:expr) => {{
            let temp = $x;  // üîí ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå (‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ä‡∏ô!)
            temp * 2        // üßÆ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå!
        }};
    }

    let temp = 5;                        // üè† ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå
    let result = using_internal_var!(10); // ü™Ñ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå!

    println!("\nüîç === ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î === üîç");
    println!("üè† ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ temp ‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å: {temp}");      // ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡πÄ‡∏õ‡πá‡∏ô 5!
    println!("ü™Ñ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å macro: {result}");      // ‡πÄ‡∏õ‡πá‡∏ô 20!
    println!("‚úÖüõ°Ô∏è Macro hygiene ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á - ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÑ‡∏°‡πà‡∏ä‡∏ô‡∏Å‡∏±‡∏ô! ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢! üéâ");

    // üÜï Macro ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á identifier ‡πÉ‡∏´‡∏°‡πà - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÉ‡∏´‡∏°‡πà! üé≠‚ú®
    macro_rules! create_var {
        ($var_name:ident, $value:expr) => {
            let $var_name = $value;  // üéØ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå!
        };
    }

    println!("\nüÜï === ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÉ‡∏´‡∏°‡πà === üÜï");
    create_var!(my_number, 42);           // üî¢ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå!
    create_var!(my_string, "Hello Rust"); // üìù ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå!

    println!("üé≠ ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å macro:");
    println!("   üî¢ my_number = {my_number}");  // ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå!
    println!("   üìù my_string = {my_string}");  // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå!
}

/// ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á macro ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á‡πÅ‡∏ö‡∏ö Advanced Wizardry! üßô‚Äç‚ôÇÔ∏èüîÆ
pub fn advanced_macro_examples() {
    println!("\nüöÄ‚ú® === ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Advanced Macros - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á! === ‚ú®üöÄ");
    println!("üßô‚Äç‚ôÇÔ∏è ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏°‡∏≤‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå! üéì");

    // üéØ Macro ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ nested patterns - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏à‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÅ‡∏ö‡∏ö Pattern Wizard! üîç‚ú®
    macro_rules! nested_match {
        ($expr:expr; $($pattern:pat => $result:expr),* $(,)?) => {
            match $expr {
                $(
                    $pattern => {
                        println!("üéØ‚ú® Pattern matched: {} ü™Ñ", stringify!($pattern));  // üé≠ ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏à‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!
                        $result
                    }
                )*
            }
        };
    }

    println!("\nüéØ === ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏à‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö === üéØ");
    let value = 42;  // üî¢ ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå!
    let result = nested_match! {
        value;
        0 => "zero",        // üö´ ‡∏®‡∏π‡∏ô‡∏¢‡πå!
        1..=10 => "small",   // ü§è ‡πÄ‡∏•‡πá‡∏Å!
        11..=50 => "medium", // üìè ‡∏Å‡∏•‡∏≤‡∏á!
        _ => "large"         // ü¶£ ‡πÉ‡∏´‡∏ç‡πà!
    };

    println!("üìäüéâ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå: {result} ‚ú®");

    // üèóÔ∏è Macro ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á multiple items - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏™‡∏¥‡πà‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô! üé≠‚ú®
    macro_rules! create_enum_and_impl {
        ($enum_name:ident { $($variant:ident),* }) => {
            #[derive(Debug, PartialEq)]  // üéØ ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå derive!
            enum $enum_name {
                $($variant,)*            // üé® ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î!
            }

            impl $enum_name {            // üõ†Ô∏è ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå implementation!
                fn all_variants() -> Vec<Self> {
                    vec![
                        $(Self::$variant,)*  // üì¶ ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î!
                    ]
                }

                fn variant_count() -> usize {
                    Self::all_variants().len()  // üî¢ ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å!
                }
            }
        };
    }

    println!("\nüé® === ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á Enum ‡πÅ‡∏•‡∏∞ Implementation === üé®");
    create_enum_and_impl!(Color {  // üé® ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏µ!
        Red,     // ‚ù§Ô∏è ‡πÅ‡∏î‡∏á!
        Green,   // üíö ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß!
        Blue,    // üíô ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô!
        Yellow   // üíõ ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á!
    });

    println!("üåà ‡∏™‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå: {:?}", Color::all_variants());
    println!("üî¢‚ú® ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏µ: {} ‡∏™‡∏µ! üé®", Color::variant_count());
}

/// ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á macro recursion - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÅ‡∏ö‡∏ö Recursive Spells! üîÑüîÆ
pub fn recursive_macro_examples() {
    println!("\nüîÑ‚ú® === ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Recursive Macros - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á! === ‚ú®üîÑ");
    println!("ü™Ñ ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÅ‡∏ö‡∏ö infinite magic! ‚ôæÔ∏è");

    // üîó Macro ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á nested tuples - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏π‡πÄ‡∏õ‡∏¥‡∏•‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô! üì¶‚ú®
    macro_rules! nested_tuple {
        ($single:expr) => {
            $single  // üéØ ‡∏Å‡∏£‡∏ì‡∏µ‡∏ê‡∏≤‡∏ô - ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå!
        };
        ($first:expr, $($rest:expr),+) => {
            ($first, nested_tuple!($($rest),+))  // üîÑ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÅ‡∏ö‡∏ö recursive magic!
        };
    }

    println!("\nüîó === ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏π‡πÄ‡∏õ‡∏¥‡∏•‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô === üîó");
    let tuple = nested_tuple!(1, 2, 3, 4, 5);  // ü™Ñ ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏π‡πÄ‡∏õ‡∏¥‡∏•‡∏ã‡πâ‡∏≠‡∏ô!
    println!("üì¶‚ú® Nested tuple ‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå: {tuple:?} üéâ");

    // üßÆ Macro ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì factorial ‡∏ó‡∏µ‡πà compile time - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ü‡∏Å‡∏ó‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏•! üî¢‚ú®
    // ‚ö†Ô∏è Warning: macro `factorial` ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á warning "unused macro definition" (‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏Å‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå!)
    // üé≠ ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•: macro ‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏ò‡∏¥‡∏ï‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î recursive macro ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
    // üîÆ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏û‡∏£‡∏≤‡∏∞ Rust ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö recursive macro expansion ‡∏ó‡∏µ‡πà runtime
    // üìö ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô recursive macro pattern

    #[allow(unused_macros)]  // ü§´ ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á warning ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏ô‡∏µ‡πâ!
    macro_rules! factorial {
        (0) => {
            1  // üéØ ‡∏Å‡∏£‡∏ì‡∏µ‡∏ê‡∏≤‡∏ô: 0! = 1
        };
        (1) => {
            1  // üéØ ‡∏Å‡∏£‡∏ì‡∏µ‡∏ê‡∏≤‡∏ô: 1! = 1
        };
        ($n:expr) => {
            $n * factorial!($n - 1)  // üîÑ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÅ‡∏ö‡∏ö recursive!
        };
    }

    println!("\nüßÆ === ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ü‡∏Å‡∏ó‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏• === üßÆ");
    // üìù Note: ‡∏ô‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î - ‡πÉ‡∏ô Rust ‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ const fn
    println!("üî¢‚ú® Factorial concept (5! = 120) - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î! üéì");

    // ‚õìÔ∏è Macro ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á chain of function calls - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô! üîó‚ú®
    macro_rules! chain_calls {
        ($value:expr) => {
            $value  // üéØ ‡∏Å‡∏£‡∏ì‡∏µ‡∏ê‡∏≤‡∏ô - ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠!
        };
        ($value:expr, $method:ident $(, $($args:expr),*)?) => {
            $value.$method($($($args),*)?)  // ü™Ñ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏°‡∏ò‡∏≠‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß!
        };
        ($value:expr, $method:ident $(, $($args:expr),*)?, $($rest:tt)*) => {
            chain_calls!($value.$method($($($args),*)?), $($rest)*)  // üîÑ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ï‡πà‡∏≠‡πÑ‡∏õ!
        };
    }

    println!("\n‚õìÔ∏è === ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô === ‚õìÔ∏è");
    let text = "  hello world  ";  // üìù ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö
    let result = text.trim().to_uppercase().replace("WORLD", "RUST");  // üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏ö‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥
    println!("‚õìÔ∏è‚ú® Chain result: {result} ü™Ñ");

    // üîó ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ chain_calls macro ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ - ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏á‡πà‡∏≤‡∏¢‡πÜ!
    let simple_result = chain_calls!(text, trim);  // ü™Ñ ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏ï‡∏±‡∏î‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á!
    println!("üîóüéØ Simple chain: '{simple_result}' ‚ú®");
    
    println!("\nüéâ ‡πÄ‡∏ß‡∏ó‡∏°‡∏ô‡∏ï‡∏£‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üßπ‚ú®");
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_macro_hygiene() {
        macro_rules! using_internal_var {
            ($x:expr) => {{
                let temp = $x;
                temp * 2
            }};
        }

        let temp = 5;
        let result = using_internal_var!(10);

        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ temp ‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
        assert_eq!(temp, 5);
        assert_eq!(result, 20);
    }

    #[test]
    fn test_create_var_macro() {
        macro_rules! create_var {
            ($var_name:ident, $value:expr) => {
                let $var_name = $value;
            };
        }

        create_var!(test_var, 42);
        assert_eq!(test_var, 42);
    }

    #[test]
    fn test_nested_tuple_macro() {
        macro_rules! nested_tuple {
            ($single:expr) => {
                $single
            };
            ($first:expr, $($rest:expr),+) => {
                ($first, nested_tuple!($($rest),+))
            };
        }

        let tuple = nested_tuple!(1, 2, 3);
        assert_eq!(tuple, (1, (2, 3)));
    }

    #[test]
    fn test_macro_hygiene_functions() {
        // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà panic
        macro_hygiene_examples();
        advanced_macro_examples();
        recursive_macro_examples();
    }
}