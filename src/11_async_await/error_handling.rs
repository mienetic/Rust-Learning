//! Async Error Handling - à¸¨à¸¹à¸™à¸¢à¹Œà¸à¸¹à¹‰à¸ à¸±à¸¢à¹à¸«à¹ˆà¸‡à¸­à¸™à¸²à¸„à¸•! ðŸš¨âš¡
//!
//! ðŸŽ¯ **à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸à¸²à¸£à¹€à¸£à¸µà¸¢à¸™à¸£à¸¹à¹‰:**
//! à¸¢à¸´à¸™à¸”à¸µà¸•à¹‰à¸­à¸™à¸£à¸±à¸šà¸ªà¸¹à¹ˆà¸¨à¸¹à¸™à¸¢à¹Œà¸à¸¹à¹‰à¸ à¸±à¸¢à¸—à¸µà¹ˆà¸—à¸±à¸™à¸ªà¸¡à¸±à¸¢à¸—à¸µà¹ˆà¸ªà¸¸à¸”! ðŸš¨âœ¨
//! à¸—à¸µà¹ˆà¸™à¸µà¹ˆà¸„à¸¸à¸“à¸ˆà¸°à¹„à¸”à¹‰à¹€à¸£à¸µà¸¢à¸™à¸£à¸¹à¹‰à¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”à¹ƒà¸™à¹‚à¸¥à¸ async à¸­à¸¢à¹ˆà¸²à¸‡à¸¡à¸·à¸­à¸­à¸²à¸Šà¸µà¸ž! ðŸš€
//!
//! ðŸ› ï¸ **à¸ªà¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¸ˆà¸°à¹„à¸”à¹‰à¹€à¸£à¸µà¸¢à¸™à¸£à¸¹à¹‰:**
//! - ðŸš¨ à¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£ error à¹ƒà¸™ async context - à¸—à¸µà¸¡à¸à¸¹à¹‰à¸ à¸±à¸¢à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¹€à¸„à¸¢à¸žà¸¥à¸²à¸”!
//! - âœ… à¸à¸²à¸£à¹ƒà¸Šà¹‰ Result à¸à¸±à¸š async functions - à¸£à¸°à¸šà¸šà¸£à¸²à¸¢à¸‡à¸²à¸™à¸œà¸¥à¸—à¸µà¹ˆà¹à¸¡à¹ˆà¸™à¸¢à¸³!
//! - ðŸ“¡ Error propagation à¹ƒà¸™ async code - à¸ªà¹ˆà¸‡à¸ªà¸±à¸à¸à¸²à¸“à¸‚à¸­à¸„à¸§à¸²à¸¡à¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­!
//! - ðŸ”„ à¸à¸²à¸£à¹ƒà¸Šà¹‰ `try_join`! à¸ªà¸³à¸«à¸£à¸±à¸š error handling - à¸—à¸µà¸¡à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­à¸à¸±à¸™!
//!
//! âš ï¸ **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸à¸ªà¸³à¸„à¸±à¸ (à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸—à¸„à¸™à¸´à¸„):**
//! - ðŸ“¦ `use tokio::time::sleep;` à¹à¸¥à¸° `use std::time::Duration;` à¸­à¸²à¸ˆà¹à¸ªà¸”à¸‡ warning "unused import"
//! - ðŸ”§ à¹€à¸«à¸•à¸¸à¸œà¸¥: imports à¹€à¸«à¸¥à¹ˆà¸²à¸™à¸µà¹‰à¹ƒà¸Šà¹‰à¹ƒà¸™à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ async à¸—à¸µà¹ˆà¸–à¸¹à¸à¹€à¸£à¸µà¸¢à¸à¸ˆà¸²à¸ main module
//! - âš¡ à¸à¸²à¸£à¸¥à¸š imports à¹€à¸«à¸¥à¹ˆà¸²à¸™à¸µà¹‰à¸ˆà¸°à¸—à¸³à¹ƒà¸«à¹‰à¹‚à¸„à¹‰à¸”à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸– compile à¹„à¸”à¹‰
//! - ðŸ¤– Warnings à¹€à¸«à¸¥à¹ˆà¸²à¸™à¸µà¹‰à¹€à¸à¸´à¸”à¸ˆà¸²à¸à¸à¸²à¸£à¸—à¸µà¹ˆ Rust analyzer à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¹ƒà¸™ async context à¹„à¸”à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œ

use std::time::Duration;
use tokio::time::sleep;

/// à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£ error à¹ƒà¸™ async context - à¸—à¸µà¸¡à¸à¸¹à¹‰à¸ à¸±à¸¢à¹ƒà¸™à¸ à¸²à¸£à¸à¸´à¸ˆ! ðŸš¨ðŸš€
#[allow(clippy::items_after_statements)]
pub async fn async_error_handling() {
    println!("\nâš ï¸ðŸš¨ === à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ Error Handling à¹ƒà¸™ Async: à¸—à¸µà¸¡à¸à¸¹à¹‰à¸ à¸±à¸¢à¹ƒà¸™à¸ à¸²à¸£à¸à¸´à¸ˆ! === ðŸš¨âš ï¸");
    println!("ðŸŒŸ à¹€à¸•à¸£à¸µà¸¢à¸¡à¸žà¸šà¸à¸±à¸šà¸—à¸µà¸¡à¸à¸¹à¹‰à¸ à¸±à¸¢à¸—à¸µà¹ˆà¸žà¸£à¹‰à¸­à¸¡à¸£à¸±à¸šà¸¡à¸·à¸­à¸—à¸¸à¸à¸ªà¸–à¸²à¸™à¸à¸²à¸£à¸“à¹Œ! (à¹„à¸¡à¹ˆà¸¡à¸µà¸ à¸²à¸£à¸à¸´à¸ˆà¹„à¸«à¸™à¸¢à¸²à¸!) ðŸšâœ¨");

    async fn risky_operation(should_fail: bool) -> Result<String, &'static str> {
        sleep(Duration::from_millis(200)).await;

        if should_fail {
            Err("ðŸš¨ à¹€à¸à¸´à¸”à¹€à¸«à¸•à¸¸à¸‰à¸¸à¸à¹€à¸‰à¸´à¸™! à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸„à¸§à¸²à¸¡à¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­! ðŸ†˜")
        } else {
            Ok("âœ… à¸ à¸²à¸£à¸à¸´à¸ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ! à¸—à¸¸à¸à¸„à¸™à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢! ðŸŽ‰".to_string())
        }
    }

    // à¸—à¸”à¸ªà¸­à¸š error handling - à¸ªà¹ˆà¸‡à¸—à¸µà¸¡à¸à¸¹à¹‰à¸ à¸±à¸¢à¸­à¸­à¸à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸à¸²à¸£! ðŸš
    println!("ðŸš à¸ªà¹ˆà¸‡à¸—à¸µà¸¡à¸à¸¹à¹‰à¸ à¸±à¸¢ 3 à¸«à¸™à¹ˆà¸§à¸¢à¸­à¸­à¸à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸à¸²à¸£! (à¸žà¸£à¹‰à¸­à¸¡à¸£à¸±à¸šà¸¡à¸·à¸­à¸—à¸¸à¸à¸ªà¸–à¸²à¸™à¸à¸²à¸£à¸“à¹Œ!) ðŸŽ¯");
    let results = tokio::join!(
        risky_operation(false),
        risky_operation(true),
        risky_operation(false)
    );

    #[allow(clippy::tuple_array_conversions)]
    let results_vec = [results.0, results.1, results.2];
    println!("ðŸ“Š à¸£à¸²à¸¢à¸‡à¸²à¸™à¸œà¸¥à¸à¸²à¸£à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸à¸²à¸£:");
    for (i, result) in results_vec.into_iter().enumerate() {
        match result {
            Ok(msg) => println!("âœ…ðŸ† à¸«à¸™à¹ˆà¸§à¸¢à¸à¸¹à¹‰à¸ à¸±à¸¢ {}: {} ðŸŒŸ", i + 1, msg),
            Err(err) => println!("âŒðŸš¨ à¸«à¸™à¹ˆà¸§à¸¢à¸à¸¹à¹‰à¸ à¸±à¸¢ {}: {} ðŸ“¡", i + 1, err),
        }
    }
    println!("ðŸŽŠ à¸ à¸²à¸£à¸à¸´à¸ˆà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™! à¸—à¸µà¸¡à¸à¸¹à¹‰à¸ à¸±à¸¢à¸à¸¥à¸±à¸šà¸à¸²à¸™à¹à¸¥à¹‰à¸§! ðŸ âœ¨");
}

/// à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¸²à¸£à¹ƒà¸Šà¹‰ `try_join`! à¸ªà¸³à¸«à¸£à¸±à¸š early error return - à¸—à¸µà¸¡à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­à¸à¸±à¸™! ðŸ¤âš¡
#[allow(clippy::items_after_statements)]
pub async fn try_join_error_handling() {
    println!("\nðŸ”„ðŸ¤ === à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ try_join! Error Handling: à¸—à¸µà¸¡à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­à¸à¸±à¸™! === ðŸ¤ðŸ”„");
    println!("ðŸŒŸ à¹€à¸•à¸£à¸µà¸¢à¸¡à¸žà¸šà¸à¸±à¸šà¸—à¸µà¸¡à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸—à¸³à¸‡à¸²à¸™à¸£à¹ˆà¸§à¸¡à¸à¸±à¸™! (à¸«à¸²à¸à¹ƒà¸„à¸£à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§ à¸—à¸¸à¸à¸„à¸™à¸«à¸¢à¸¸à¸”à¸Šà¹ˆà¸§à¸¢à¸à¸±à¸™!) ðŸš€âœ¨");

    async fn fallible_task(id: u32, should_fail: bool) -> Result<String, String> {
        sleep(Duration::from_millis(100 * u64::from(id))).await;

        if should_fail {
            Err(format!("ðŸš¨ à¸ªà¸¡à¸²à¸Šà¸´à¸à¸—à¸µà¸¡ {id} à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸„à¸§à¸²à¸¡à¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­! ðŸ†˜"))
        } else {
            Ok(format!("âœ… à¸ªà¸¡à¸²à¸Šà¸´à¸à¸—à¸µà¸¡ {id} à¸—à¸³à¸‡à¸²à¸™à¸ªà¸³à¹€à¸£à¹‡à¸ˆ! ðŸŽ‰"))
        }
    }

    // à¸—à¸”à¸ªà¸­à¸šà¸à¸£à¸“à¸µà¸—à¸µà¹ˆà¸—à¸¸à¸ task à¸ªà¸³à¹€à¸£à¹‡à¸ˆ - à¸—à¸µà¸¡à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œà¹à¸šà¸š! ðŸ†
    println!("ðŸ“‹ðŸ† à¸—à¸”à¸ªà¸­à¸šà¸à¸£à¸“à¸µà¸—à¸µà¸¡à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œà¹à¸šà¸š:");
    match tokio::try_join!(
        fallible_task(1, false),
        fallible_task(2, false),
        fallible_task(3, false)
    ) {
        Ok((result1, result2, result3)) => {
            println!("âœ…ðŸŽŠ à¸—à¸¸à¸à¸ªà¸¡à¸²à¸Šà¸´à¸à¸—à¸µà¸¡à¸—à¸³à¸‡à¸²à¸™à¸ªà¸³à¹€à¸£à¹‡à¸ˆ! {result1}, {result2}, {result3} ðŸŒŸ");
        }
        Err(e) => println!("âŒðŸš¨ à¸—à¸µà¸¡à¸‡à¸²à¸™à¸¡à¸µà¸›à¸±à¸à¸«à¸²: {e} ðŸ“¡"),
    }

    // à¸—à¸”à¸ªà¸­à¸šà¸à¸£à¸“à¸µà¸—à¸µà¹ˆà¸¡à¸µ task à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§ - à¸—à¸µà¸¡à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­à¸à¸±à¸™! ðŸ¤
    println!("\nðŸ“‹ðŸ¤ à¸—à¸”à¸ªà¸­à¸šà¸à¸£à¸“à¸µà¸—à¸µà¸¡à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­à¸à¸±à¸™:");
    match tokio::try_join!(
        fallible_task(1, false),
        fallible_task(2, true), // à¸ªà¸¡à¸²à¸Šà¸´à¸à¸„à¸™à¸™à¸µà¹‰à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸„à¸§à¸²à¸¡à¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­! ðŸ†˜
        fallible_task(3, false)
    ) {
        Ok((result1, result2, result3)) => {
            println!("âœ…ðŸŽŠ à¸—à¸¸à¸à¸ªà¸¡à¸²à¸Šà¸´à¸à¸—à¸µà¸¡à¸—à¸³à¸‡à¸²à¸™à¸ªà¸³à¹€à¸£à¹‡à¸ˆ! {result1}, {result2}, {result3} ðŸŒŸ");
        }
        Err(e) => println!("âŒðŸ¤ à¸—à¸µà¸¡à¸‡à¸²à¸™à¸«à¸¢à¸¸à¸”à¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­à¸ªà¸¡à¸²à¸Šà¸´à¸ (à¸„à¸²à¸”à¸«à¸§à¸±à¸‡): {e} ðŸ’ª"),
    }
    println!("ðŸŽ‰ à¸™à¸µà¹ˆà¸„à¸·à¸­à¸žà¸¥à¸±à¸‡à¸‚à¸­à¸‡à¸—à¸µà¸¡à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸”à¸µ! à¹„à¸¡à¹ˆà¸—à¸´à¹‰à¸‡à¹ƒà¸„à¸£à¹„à¸§à¹‰à¸‚à¹‰à¸²à¸‡à¸«à¸¥à¸±à¸‡! ðŸŒˆâœ¨");
}

/// à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¸²à¸£ propagate errors à¹ƒà¸™ async functions - à¸ªà¸²à¸¢à¸à¸²à¸£à¸œà¸¥à¸´à¸•à¹à¸«à¹ˆà¸‡à¸­à¸™à¸²à¸„à¸•! ðŸ­âš¡
#[allow(clippy::items_after_statements)]
pub async fn error_propagation_example() {
    println!("\nðŸ”„ðŸ­ === à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ Error Propagation: à¸ªà¸²à¸¢à¸à¸²à¸£à¸œà¸¥à¸´à¸•à¹à¸«à¹ˆà¸‡à¸­à¸™à¸²à¸„à¸•! === ðŸ­ðŸ”„");
    println!("ðŸŒŸ à¹€à¸•à¸£à¸µà¸¢à¸¡à¸žà¸šà¸à¸±à¸šà¸ªà¸²à¸¢à¸à¸²à¸£à¸œà¸¥à¸´à¸•à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸œà¹ˆà¸²à¸™à¸—à¸¸à¸à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™! (à¸«à¸²à¸à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¹ƒà¸”à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§ à¸ˆà¸°à¸«à¸¢à¸¸à¸”à¸—à¸±à¸™à¸—à¸µ!) ðŸš€âœ¨");

    async fn step1() -> Result<String, &'static str> {
        sleep(Duration::from_millis(100)).await;
        Ok("ðŸ”§ à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 1: à¹€à¸•à¸£à¸µà¸¢à¸¡à¸§à¸±à¸•à¸–à¸¸à¸”à¸´à¸š à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!".to_string())
    }

    async fn step2() -> Result<String, &'static str> {
        sleep(Duration::from_millis(100)).await;
        Err("âš ï¸ à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 2: à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸ˆà¸±à¸à¸£à¸‚à¸±à¸”à¸‚à¹‰à¸­à¸‡!")
    }

    async fn step3() -> Result<String, &'static str> {
        sleep(Duration::from_millis(100)).await;
        Ok("ðŸ“¦ à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 3: à¸šà¸£à¸£à¸ˆà¸¸à¸ à¸±à¸“à¸‘à¹Œ à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!".to_string())
    }

    async fn multi_step_operation() -> Result<String, &'static str> {
        let result1 = step1().await?; // à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¹à¸£à¸ ðŸ”§
        let result2 = step2().await?; // à¸ˆà¸°à¸«à¸¢à¸¸à¸”à¸—à¸µà¹ˆà¸™à¸µà¹ˆà¹€à¸¡à¸·à¹ˆà¸­à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸ˆà¸±à¸à¸£à¸‚à¸±à¸”à¸‚à¹‰à¸­à¸‡! âš ï¸
        let result3 = step3().await?; // à¹„à¸¡à¹ˆà¸¡à¸µà¹‚à¸­à¸à¸²à¸ªà¸–à¸¶à¸‡à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸™à¸µà¹‰ ðŸ“¦

        Ok(format!("{result1} â†’ {result2} â†’ {result3}"))
    }

    match multi_step_operation().await {
        Ok(result) => println!("âœ…ðŸ† à¸ªà¸²à¸¢à¸à¸²à¸£à¸œà¸¥à¸´à¸•à¸—à¸³à¸‡à¸²à¸™à¸ªà¸³à¹€à¸£à¹‡à¸ˆ: {result} ðŸŽ‰"),
        Err(e) => println!("âŒðŸš¨ à¸ªà¸²à¸¢à¸à¸²à¸£à¸œà¸¥à¸´à¸•à¸«à¸¢à¸¸à¸”à¸—à¸³à¸‡à¸²à¸™: {e} ðŸ”§"),
    }
    println!("ðŸŽ¯ à¸™à¸µà¹ˆà¸„à¸·à¸­à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸‚à¸­à¸‡ Error Propagation! à¸«à¸¢à¸¸à¸”à¸—à¸±à¸™à¸—à¸µà¹€à¸¡à¸·à¹ˆà¸­à¸žà¸šà¸›à¸±à¸à¸«à¸²! ðŸŒˆâœ¨");
}

/// à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¸²à¸£à¹ƒà¸Šà¹‰ timeout à¸à¸±à¸š async operations - à¸™à¸²à¸¬à¸´à¸à¸²à¸ˆà¸±à¸šà¹€à¸§à¸¥à¸²à¹à¸«à¹ˆà¸‡à¸­à¸™à¸²à¸„à¸•! â°âš¡
#[allow(clippy::items_after_statements)]
pub async fn timeout_example() {
    println!("\nâ°ðŸš€ === à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ Timeout Handling: à¸™à¸²à¸¬à¸´à¸à¸²à¸ˆà¸±à¸šà¹€à¸§à¸¥à¸²à¹à¸«à¹ˆà¸‡à¸­à¸™à¸²à¸„à¸•! === ðŸš€â°");
    println!("ðŸŒŸ à¹€à¸•à¸£à¸µà¸¢à¸¡à¸žà¸šà¸à¸±à¸šà¸à¸²à¸£à¹à¸‚à¹ˆà¸‡à¸‚à¸±à¸™à¸à¸±à¸šà¹€à¸§à¸¥à¸²! (à¸«à¸²à¸à¸Šà¹‰à¸²à¹€à¸à¸´à¸™à¹„à¸› à¸ˆà¸°à¸–à¸¹à¸à¸«à¸¢à¸¸à¸”à¸—à¸±à¸™à¸—à¸µ!) ðŸƒâ€â™‚ï¸âœ¨");

    async fn slow_operation(duration: u64) -> Result<String, &'static str> {
         sleep(Duration::from_millis(duration)).await;
         Ok("ðŸŽ¯ à¸ à¸²à¸£à¸à¸´à¸ˆà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™! ðŸ".to_string())
     }

    // à¸—à¸”à¸ªà¸­à¸š operation à¸—à¸µà¹ˆà¹€à¸ªà¸£à¹‡à¸ˆà¸—à¸±à¸™à¹€à¸§à¸¥à¸² - à¸™à¸±à¸à¸§à¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¸£à¸§à¸”à¹€à¸£à¹‡à¸§! ðŸƒâ€â™‚ï¸ðŸ’¨
    println!("ðŸ“‹ðŸƒâ€â™‚ï¸ à¸—à¸”à¸ªà¸­à¸šà¸™à¸±à¸à¸§à¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¸£à¸§à¸”à¹€à¸£à¹‡à¸§ (à¹€à¸§à¸¥à¸²à¸ˆà¸³à¸à¸±à¸” 500ms):");
    match tokio::time::timeout(Duration::from_millis(500), slow_operation(300)).await {
        Ok(Ok(result)) => println!("âœ…ðŸ† à¹€à¸ªà¸£à¹‡à¸ˆà¸—à¸±à¸™à¹€à¸§à¸¥à¸²! {result} ðŸŽ‰"),
        Ok(Err(e)) => println!("âŒðŸš¨ à¸ à¸²à¸£à¸à¸´à¸ˆà¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: {e} ðŸ“¡"),
        Err(_) => println!("â°ðŸš¨ à¸«à¸¡à¸”à¹€à¸§à¸¥à¸²! à¸™à¸±à¸à¸§à¸´à¹ˆà¸‡à¸Šà¹‰à¸²à¹€à¸à¸´à¸™à¹„à¸›! ðŸŒ"),
    }

    // à¸—à¸”à¸ªà¸­à¸š operation à¸—à¸µà¹ˆ timeout - à¸™à¸±à¸à¸§à¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¸Šà¹‰à¸²! ðŸŒ
    println!("\nðŸ“‹ðŸŒ à¸—à¸”à¸ªà¸­à¸šà¸™à¸±à¸à¸§à¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¸Šà¹‰à¸² (à¹€à¸§à¸¥à¸²à¸ˆà¸³à¸à¸±à¸” 200ms):");
    match tokio::time::timeout(Duration::from_millis(200), slow_operation(500)).await {
        Ok(Ok(result)) => println!("âœ…ðŸ† à¹€à¸ªà¸£à¹‡à¸ˆà¸—à¸±à¸™à¹€à¸§à¸¥à¸²! {result} ðŸŽ‰"),
        Ok(Err(e)) => println!("âŒðŸš¨ à¸ à¸²à¸£à¸à¸´à¸ˆà¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: {e} ðŸ“¡"),
        Err(_) => println!("â°ðŸš¨ à¸«à¸¡à¸”à¹€à¸§à¸¥à¸²! à¸™à¸±à¸à¸§à¸´à¹ˆà¸‡à¸Šà¹‰à¸²à¹€à¸à¸´à¸™à¹„à¸›! (à¸„à¸²à¸”à¸«à¸§à¸±à¸‡) ðŸŒðŸ’”"),
    }
    println!("ðŸŽ¯ à¸™à¸µà¹ˆà¸„à¸·à¸­à¸žà¸¥à¸±à¸‡à¸‚à¸­à¸‡ Timeout! à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¹ƒà¸„à¸£à¸¡à¸²à¸—à¸³à¹ƒà¸«à¹‰à¹€à¸£à¸²à¸Šà¹‰à¸²! ðŸŒˆâœ¨");
}

/// à¸£à¸±à¸™à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸‚à¸­à¸‡ error handling - à¹€à¸›à¸´à¸”à¸¨à¸¹à¸™à¸¢à¹Œà¸à¸¹à¹‰à¸ à¸±à¸¢à¹à¸«à¹ˆà¸‡à¸­à¸™à¸²à¸„à¸•! ðŸš‘âš¡
pub async fn run_error_handling_examples() {
    println!("ðŸš€ðŸš‘ === à¹€à¸›à¸´à¸”à¸¨à¸¹à¸™à¸¢à¹Œà¸à¸¹à¹‰à¸ à¸±à¸¢à¹à¸«à¹ˆà¸‡à¸­à¸™à¸²à¸„à¸•! === ðŸš‘ðŸš€");
    println!("ðŸŒŸ à¸¢à¸´à¸™à¸”à¸µà¸•à¹‰à¸­à¸™à¸£à¸±à¸šà¸ªà¸¹à¹ˆà¸¨à¸¹à¸™à¸¢à¹Œà¸à¸¶à¸à¸­à¸šà¸£à¸¡à¸—à¸µà¸¡à¸à¸¹à¹‰à¸ à¸±à¸¢à¸¡à¸·à¸­à¸­à¸²à¸Šà¸µà¸ž! ðŸŽ“âœ¨");

    async_error_handling().await;
    try_join_error_handling().await;
    error_propagation_example().await;
    timeout_example().await;

    println!("\nðŸŽ‰ðŸ† === à¸¨à¸¹à¸™à¸¢à¹Œà¸à¸¹à¹‰à¸ à¸±à¸¢à¹à¸«à¹ˆà¸‡à¸­à¸™à¸²à¸„à¸•à¸›à¸´à¸”à¸à¸²à¸£à¸à¸¶à¸à¸­à¸šà¸£à¸¡! === ðŸ†ðŸŽ‰");
    println!("ðŸŒˆ à¸‚à¸­à¸šà¸„à¸¸à¸“à¸—à¸µà¹ˆà¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡à¸à¸²à¸£à¸à¸¶à¸à¸­à¸šà¸£à¸¡! à¸•à¸­à¸™à¸™à¸µà¹‰à¸„à¸¸à¸“à¸žà¸£à¹‰à¸­à¸¡à¹€à¸›à¹‡à¸™à¸—à¸µà¸¡à¸à¸¹à¹‰à¸ à¸±à¸¢à¸¡à¸·à¸­à¸­à¸²à¸Šà¸µà¸žà¹à¸¥à¹‰à¸§! ðŸš€âœ¨");
}

#[cfg(test)]
mod tests {
    use super::*;
    use tokio::test;

    #[test]
    async fn test_error_handling() {
        // Test helper function - async signature needed for consistency with real async operations
        #[allow(clippy::unused_async)]
        async fn test_operation(should_fail: bool) -> Result<i32, &'static str> {
            if should_fail {
                Err("test error")
            } else {
                Ok(42)
            }
        }

        // à¸—à¸”à¸ªà¸­à¸šà¸à¸£à¸“à¸µà¸ªà¸³à¹€à¸£à¹‡à¸ˆ
        let result = test_operation(false).await;
        assert!(result.is_ok());
        assert_eq!(result.unwrap(), 42);

        // à¸—à¸”à¸ªà¸­à¸šà¸à¸£à¸“à¸µà¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§
        let result = test_operation(true).await;
        assert!(result.is_err());
        assert_eq!(result.unwrap_err(), "test error");
    }

    #[test]
    async fn test_try_join_success() {
        // Test helper function - async signature needed for try_join! macro compatibility
        #[allow(clippy::unused_async)]
        async fn success_task(value: i32) -> Result<i32, &'static str> {
            Ok(value * 2)
        }

        let result = tokio::try_join!(success_task(1), success_task(2), success_task(3));

        assert!(result.is_ok());
        let (r1, r2, r3) = result.unwrap();
        assert_eq!((r1, r2, r3), (2, 4, 6));
    }

    #[test]
    async fn test_try_join_failure() {
        // Test helper function - async signature needed for try_join! macro compatibility
        #[allow(clippy::unused_async)]
        async fn maybe_fail_task(should_fail: bool) -> Result<i32, &'static str> {
            if should_fail { Err("failed") } else { Ok(42) }
        }

        let result = tokio::try_join!(
            maybe_fail_task(false),
            maybe_fail_task(true), // à¸™à¸µà¹ˆà¸ˆà¸°à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§
            maybe_fail_task(false)
        );

        assert!(result.is_err());
        assert_eq!(result.unwrap_err(), "failed");
    }

    #[test]
    async fn test_timeout() {
        async fn quick_task() -> Result<i32, &'static str> {
            sleep(Duration::from_millis(10)).await;
            Ok(42)
        }

        async fn slow_task() -> Result<i32, &'static str> {
            sleep(Duration::from_millis(200)).await;
            Ok(42)
        }

        // à¸—à¸”à¸ªà¸­à¸š task à¸—à¸µà¹ˆà¹€à¸ªà¸£à¹‡à¸ˆà¸—à¸±à¸™à¹€à¸§à¸¥à¸²
        let result = tokio::time::timeout(Duration::from_millis(100), quick_task()).await;
        assert!(result.is_ok());
        assert_eq!(result.unwrap().unwrap(), 42);

        // à¸—à¸”à¸ªà¸­à¸š task à¸—à¸µà¹ˆ timeout
        let result = tokio::time::timeout(Duration::from_millis(50), slow_task()).await;
        assert!(result.is_err()); // timeout error
    }
}